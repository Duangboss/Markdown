[toc]

#　复杂度理论基础

- 问题（problem）
- 实例（instance）
- 算法的效率通过获得最优解所需的最大计算步数来衡量
- 常见算法复杂度
  ![image-20240816105856172](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240816105856172.png)
- 归并排序的算法复杂度 O(n log(n))
- 可判定性问题：只存在对或不对为答案的问题
  - 每一个优化问题都可以关联到一个可判定性问题上
- 问题规约（problem reduction）
  - 如果对于问题 Q 的每个实例都可以构建一个与之等价的问题 Q‘的实例，则 Q reduces to Q‘
  - 多项式规约
    - 如果存在求解问题 Q 的多项式时间算法就一定存在一个求解问题 Q‘的多项式时间算法，则 Q polynomially reduces to Q‘
    - if Q polynomially reduces to Q‘，则求解问题 Q‘的复杂度至少是求解问题 Q 的复杂度
    - 如果不存在求解问题 Q 的多项式时间算法，那么问题 Q‘也不存在
- P 问题：是那些能够在多项式时间内被确定性图灵机解决的决策问题。这里的 "P" 代表 "多项式时间"（Polynomial time）
- NP 问题：NP 问题是一类可以在多项式时间内验证解正确性的决策问题。具体来说：
  - P vs NP 问题：
    - 这是一个未解决的重大数学和计算机科学问题，询问是否所有的 NP 问题都可以在多项式时间内解决。
    - 如果 P = NP，则意味着所有能够在多项式时间内验证解的问题也能在多项式时间内找到解。
    - 反之，如果 P ≠ NP，则存在一些问题，虽然能够快速验证解，但找到解的过程却需要指数级的时间。
  - NP 完全问题：这类问题是 NP 问题中最难的一类。如果一个问题属于 NP 完全问题，那么它具有这样的特性：任何其他 NP 问题都可以在多项式时间内转换为这个问题。因此，如果找到了一个有效解决 NP 完全问题的方法，那么实际上就找到了解决所有 NP 问题的方法。
  - NP-complete
    - NP-complete 是中最难的一类。
    - 这些问题属于 NP 类，即对于每个“是”的实例，存在一个多项式时间内的证明，可以验证这个答案是正确的。
    - 所有 NP 问题都可以在多项式时间内减少到任何一个 NP-complete 问题上。换句话说，如果能找到一种在多项式时间内解决 NP-complete 问题的方法，那么就能在多项式时间内解决所有 NP 问题。
    - 经典 NP 完全问题
      - 布尔满意性问题（Satisfiability，SAT 问题）：
        - 给定一个布尔变量的集合和在写变量上定义的一组子句，是否存在一个变量赋值方案，使得每一个子句都为真
      - 划分问题（Partition）：
        - 给定 t 个正整数 $S=\{a_1, ...,a_t\}$，$b=(1/2)\sum_{i=1}^{t}{a_j}$，是否存在一个划分方式，将 S 划分为两个子集 $S_1$ 和 $S_2$ 使得 $\sum_{j\in S_i}a_j=b$​
      - 3 划分问题
        - 给定 3t 个正整数 $S=\{a_1, ...,a_{3t}\}$，给定常数 b，$\frac{b}{4}<a_j<\frac{b}{2}$，$\sum_{j=1}^{3t}a_j=tb$​，判断是否存在一个划分，使得 S 可以被划分为 t 个三元子集，每个子集的元素之和均为 b
      - 汉密尔顿回路问题
        - 给定一个无向图 G =(V, E)，其中 V 是顶点集，E 是边集，汉密尔顿回路问题的任务是判断是否存在一条回路，这条回路通过每个顶点恰好一次，并且回到起点。
  - NP-hard
    ![image-20240821230819877](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240821230819877.png)
    - NP-hard 是指至少和 NP 中最难的问题一样难的一类问题。NP-hard 问题不一定属于 NP 类，这类问题可能不知道如何在多项式时间内验证其解。NP-hard 问题的特点包括：
      - 所有 NP 问题都可以在多项式时间内减少到任何一个 NP-hard 问题上。
      - NP-hard 问题的范围比 NP-complete 更广，包括 NP-complete 问题以及那些不属于 NP 的问题。
    - 简单 NP-hard (Simply NP-hard)
      - 简单 NP-hard 问题是指那些在多项式时间内无法解决的 NP-hard 问题，但它们的时间复杂度可能依赖于输入数值的大小，而不是输入的编码长度。
      - 简单 NP-hard 问题的典型特征是它们的时间复杂度与输入数值的大小成多项式关系。这类问题的算法通常被称为伪多项式时间算法。
    - 强 NP-hard (Strongly NP-hard)
      - 强 NP-hard 问题是指那些即使输入数值大小固定不变，仍然保持 NP-hard 性质的问题。这类问题的复杂性不受数值大小的影响，而是与输入的编码长度（即比特表示长度）成多项式关系。这意味着即使数值本身很小，问题仍然难以解决。
      - 区别
        - 简单 NP-hard：问题的时间复杂度依赖于输入数值的大小。
        - 强 NP-hard：问题的时间复杂度依赖于输入的编码长度，而不依赖于数值本身的大小。
      - 示例
        - 0/1 背包问题：这是一个简单 NP-hard 问题。它的经典动态规划解法的时间复杂度是 O(nW)，其中 n 是物品的数量，W 是背包的最大容量。这里的时间复杂度依赖于背包容量 W 的大小。
        - 旅行商问题 (TSP)：这是一个强 NP-hard 问题。即使所有城市之间的距离都是固定的，问题仍然是 NP-hard 的。这是因为问题的复杂性主要取决于城市的数量，而不是距离的数值大小。
  - 编码长度
    - 输入的编码长度是指将问题实例编码成计算机可以处理的形式时所需的比特数。在计算复杂性理论中，输入的编码长度通常用来衡量问题实例的大小。它是决定算法复杂性的重要因素之一。
    - 编码方式
      - 二进制编码：最常见的编码方式之一，使用 0 和 1 来表示数字和数据。
      - 数值编码：直接使用整数或浮点数来表示数值。
      - 结构化编码：对于含有结构化数据的问题，如图、树等，可以使用特定的数据结构（如邻接矩阵或邻接表）来表示。
    - 计算编码长度
      - 对于数值，编码长度通常是表示该数值所需的比特数。
      - 对于结构化的数据，编码长度通常是由构成数据的元素个数及其表示方式决定的。
    - 示例
      - 数值：假设我们需要编码一个整数 n。如果 n 是正整数，则编码长度大致为 log₂(n + 1)比特。例如，编码整数 100 需要大约 7 比特（log₂(101) ≈ 6.64）。
      - 图：对于一个无向图，如果我们使用邻接矩阵来表示，编码长度将是 n² 比特，其中 n 是顶点的数量。如果使用邻接表，则编码长度将取决于边的数量。

# 线性规划

- 数学规划问题

  - 在有限维度的向量空间中由线性和非线性约束(等式和不等式)定义的集合 上求函数极值问题的理论和方法。

  - 问题组成
    $$
    \begin{array}{l}
    min\: f(x)\\
    s.\: t.\\
    g_i(x)\geq0,\: i = 1,2,\dots, k\\
    q_j(x)= 0,\: j = 1,2,\dots, m \\
    where\ x =(x_{I}, x_{2},\cdots, x_{n})\end{array}
    $$

    - 决策变量：问题中的未知数，我们需要找到它们的最优值。
    - 目标函数：我们试图最小化或最大化的函数，通常表示为决策变量的函数。
    - 约束条件：一组限制决策变量值的条件。

  - 分类

    - 线性规划（Linear Programming, LP）：目标函数和所有约束条件都是线性的。
      - 应用场景：资源分配、生产规划、投资组合优化等。
      
    - 整数规划（Integer Programming, IP）：目标函数和约束条件可以是线性或非线性的，但变量必须取整数值。

      - 子类：

        - 纯整数规划：所有变量都是整数。
        - 混合整数规划（Mixed-Integer Programming, MIP）：部分变量是整数，部分变量是连续的。
      
      - 应用场景：网络设计、供应链管理、项目调度等。
      
    - 非线性规划（Nonlinear Programming, NLP）：目标函数或约束条件中至少有一个是非线性的。
    - 双线性规划（Bilinear Programming）是一种特殊的非线性规划问题，其中目标函数和约束条件包含两个变量的乘积。
        $f(x)=c^Tx+d^Ty+x^TQy$
      - 应用场景：化工过程优化、经济学中的效用最大化等。

    - 二次规划（Quadratic Programming, QP）：目标函数是二次函数（具有二次项），但约束条件是线性的。

      - 应用场景：金融中的投资组合优化、机器学习中的支持向量机等。

    - 动态规划（Dynamic Programming, DP）

      - 问题描述：通过将问题分解为相互依赖的子问题，递归求解。
      - 应用场景：路径优化、资源分配问题、序列决策问题等。

- 线性规划（Linear Programming, LP）问题的解：
  ![image-20240822172028823](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240822172028823.png)

  - 求解可能情况
    ![image-20240822172045659](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240822172045659.png)

    - CPF 解：线性规划约束定义的可行域中的角点（或极点）所对应的可行解。
      - 如果一个线性规划问题只有一个最优解那么他一定是 CPF 解
      - 如果一个线性规划问题有无穷多（多重）最优解，那么他一定包含两个 CPF 解

  - 凸集和极点

    - 凸集：对于集合 C，如果对集合中的任意两点 $x_1,x_2\in C$，连接这两点的线段也完全包含在这个集合内，那么集合 C 为凸集。反之为凹集
    - **定义**：在一个凸集 C 中，**极点** 是指不能表示为该集合中其他两个不同点的凸组合的点。换句话说，如果一个点 p 是凸集 C 中的极点，则不存在 C 中的两个不同点 x1, x2 和 $λ∈(0,1)$ 使得 $p=λx_1+(1−λ)x_2$

  - 解的基本性质

    - 基、基向量、基变量
      ![image-20240822172112093](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240822172112093.png)

      - 设 $r(A)=m$，并且 B 是 A 的 m 阶非奇异的子矩阵 $(det(B) ¹ 0)$, 则称矩阵 B 为线性规划问题的一个基阵或基

      - 矩阵 $B =(P_1, P_2…, P_m)$ ，列向量 $P_j$ 称为对应基 B 的基向量

      - 与基向量 $P_j$ 相对应的变量 $x_j$ 就称为基变量，其余的就称为非基变量

    - 可行解、最优解、非可行解

      - 可行解：满足非负约束条件的解称为可行解

      - 最优解：满足非负约束条件且使目标函数值达到最优的解，称为最优解

      - 非可行解：不满足非负约束条件

    - 基本解、基本可行解、可行基

      - 基本解：设对于某一特定的基 B，非基变量取 0 值的解，称为基本解
        - 基变量由将设为 0 的非基变量代入约束方程中求得
      - 基本可行解（BF solution）：满足非负约束条件的基本解，称为基本可行解（基可行解）
      - 角点解（CPF 解）：角点解是一种特殊的基本解，通常位于可行区域的边界上，是若干约束的交点。在几何上位于可行区域的一个角点上。代数上，角点解是一个基本可行解（Basic Feasible Solution，BFS）
      - 可行基：与基本可行解对应的基，称为可行基
      - 非退化解：所有基变量取值为正值的基本可行解
      - 退化解：部分基变量取值为 0 的基本可行解

    - 线性规划解的基本性质

      - 定理 1：若一个线性规划问题有可行解，则它必有基本可行解。

      - 定理 2：线性规划问题的可行解 X 为基本可行解的充分必要条件是 X 的非零分量对应的系数矩阵 A 的列向量是线性无关。

      - 定理 3：若一个线性规划问题有最优解，则一定存在一个基本可行解是它的最优解。

      - 定理 4 :

        - 线性规划问题的可行域是凸集

        - 连接线性规划问题任意两个可行解的线段上的点(凸组合)仍然是可行解

  - 单纯形法

    - 单纯形法基础

      - Constraint Boundary Equation（约束边界方程）:
        约束边界方程是线性规划问题中表示约束条件的等式形式。对于每一个不等式约束，我们可以将其转化为等式，以确定其在图形中的边界。例如，约束 $(x_1 + 2x_2 \leq 4)$ 的边界方程是 $(x_1 + 2x_2 = 4)$。这个方程表示约束条件的边界线，在这条线上满足约束的解将使得不等式变成等式。
        - Hyperplane（超平面）:
           - 超平面是多维空间中的几何对象，它是一个维度比空间本身少一维的子空间。在二维空间中，超平面是直线；在三维空间中，超平面是一个平面。

           - 在线性规划中，每个约束条件的边界方程都代表一个超平面。超平面将空间划分为两个半空间，符合约束的解位于其中一个半空间内。

      - Constraint Boundary（约束边界）:
         约束边界是由约束边界方程定义的区域。在图形表示中，约束边界是图中满足约束条件的边界线（或面）。

      - The Boundary of the Feasible Region（可行区域的边界）:
         可行区域的边界是所有约束条件的交集边界。在图形表示中，它是由所有约束边界线共同围成的多边形区域（在二维空间中）或多面体（在三维空间中）的外边界。这些边界限定了所有满足所有约束条件的解的区域。

      - Corner-point feasible (CPF) solution（角点可行解）:
         `角点可行解是位于可行区域边界上的解，这些解通常是约束边界相交的点。在线性规划中，由于目标函数在这些角点处取得极值，通常这些角点可行解是最优解的候选者。

      - Defining Equations（定义方程）:
         定义方程是确定角点可行解位置的方程集。这些方程是使得一个角点解满足多个约束条件的边界方程。
         - 如何判断一个约束边界方程是否是定义方程之一
            - 在增广形式的线性规划问题中，每个约束都有一个对应的 **松弛变量** 或 **人工变量**。这些变量帮助我们将不等式约束转化为等式，并且在单纯形法的初始表中作为基本变量。
            - 指示变量（Indicator Variable）：指示变量是指在单纯形法的当前解中，某个约束的松弛变量或人工变量是否为零。
            - **如果一个约束的指示变量为零**，这意味着当前解正好位于该约束的边界上。因此，该约束的边界方程就是当前角点解的 **定义方程之一**。

    - 求解步骤

      1. 初始化
         - 将问题转为标准形式
           
           ![image-20240825105943671](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240825110921686.png)
           <img src="https://api2.mubu.com/v3/document_image/8f3f8868-3a14-4071-b438-6e7eb5b6a2c3-8969563.jpg" alt="img" style="zoom: 33%;" />
           
           - 其中 A 为 m×n 阶矩阵，r(A) = m，且 m ≤ n
           - 标准型变换
           
             - 将目标函数转为最大化问题：MinZ 变 MaxZ'
             - 确保决策变量非负：$x_j\geq0$ 变 $x_j^′=−x_j\leq0$
               - $x_j$ 无非负限制，引进非负变量 $x_j'>=0$ 和 $x_j''>=0$，令 $x_j=x_j'-x_j''$
         - 约束条件右端项有负数，两边同乘-1
           <img src="https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240824133348836.png" alt="image-20240824133348836" style="zoom:50%;" />
         - 添加变量，将所有不等式约束转换为等式
           
           - 添加松弛变量，将所有小于等于的不等式约束转换为等式
             ![image-20240823091928681](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240823091928681.png)
           - 向等式约束中添加人工变量，并在目标函数中添加 M 惩罚
             ![image-20240824133025591](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240824133025591.png)
           - 添加剩余变量，将所有大于等于的约束条件转为等于，再在调整后的等式中加入人工变量
             ![image-20240824134015841](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240824134015841.png)
         - 构造增广矩阵，包括系数矩阵 A、右端项 b 和目标函数 c。
      2. 构造初始单纯形表：
         ![image-20240823105658536](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240823105658536.png)
         - 表的第一行通常包含目标函数 c 的系数。
         - 接下来的行包含系数矩阵 A 的行。
         - 最后一列包含右端项 b 的值。
         - 可能还需要添加一列来表示检验数（用于确定是否达到最优解）。
      3. 给出第一个基本可行解
      4. 单纯形表迭代
         - 选择进入基变量：
           - 计算检验数（目标函数系数减去对应列的乘积）。
           - 选择检验数中最大的非基变量作为进入基变量。如果所有检验数非正，则当前解是最优解，停止迭代。
         - 选择离开基变量：
           - 对于选定的进入基变量，计算最小比值测试（$b_i/a_{ij}$），其中 $a_{ij}$ 是进入基变量列的正元素。
           - 选择最小的比值对应的基变量作为离开基变量。如果所有 $a_{ij}$ 都是非正的，则说明问题无界。
         - 更新单纯形表：
           - 使用高斯消元法更新表，使得进入基变量所在的列成为单位向量，即将其化简为主元形式。
           - 更新目标函数的值和其他系数。
         - 重复步骤 1 至 3，直到达到最优解或发现问题无界。

    - 单纯形法求解结果

      - 无界解
        - 定义：如果线性规划问题的目标函数可以无限增加（对于最大化问题）或减少（对于最小化问题），那么该问题被认为是无界的。
        
        - 示例：考虑以下线性规划问题：
        
            $$
            \text{最大化 } Z = 3x_1 + 2x_2 \\
            \text{约束条件：} \\
            2x_1 + x_2 \leq 4 \\
            x_1, x_2 \geq 0
            $$
            $$
            \begin{array}{c|cccc|c}
            & x_1 & x_2 & s_1 & b \\
            \hline
            Z & 3 & 2 & 0 & 0 \\
            s_1 & 2 & 1 & 1 & 4
            \end{array}
            $$
        
            - 在这个例子中，如果我们继续迭代，会发现目标函数 \( Z \) 的系数 \( 3 \) 和 \( 2 \) 分别对应 \( x_1 \) 和 \( x_2 \) 的检验数，且没有非负的比值测试可以进行。这意味着 \( x_1 \) 或 \( x_2 \) 可以无限增大而不违反任何约束，导致 \( Z \) 也可以无限增大。
        
      - 多重最优解

        - 定义：如果线性规划问题存在多个最优解，这些解具有相同的最优目标函数值。

        - 示例：考虑以下线性规划问题：

            $$
            \text{最大化 } Z = 2x_1 + 2x_2 \\
            \text{约束条件：} \\
            x_1 + x_2 \leq 3 \\
            x_1, x_2 \geq 0
            $$

            $$
            \begin{array}{c|ccc|c}
            & x_1 & x_2 & s_1 & b \\
            \hline
            Z & 2 & 2 & 0 & 0 \\
            s_1 & 1 & 1 & 1 & 3
            \end{array}
            $$
        
           - 在这个例子中，当我们完成第一次迭代后，检验数为 \( 0 \)，表明当前解已经是最优解。但是，我们可以看到 \( x_1 \) 和 \( x_2 \) 的系数相同，这意味着我们可以沿着目标函数等值线移动到不同的角点，这些角点同样都是最优解。

      - 不可行问题

        - **定义**：如果没有任何解能够满足所有约束条件，那么线性规划问题是不可行的。

        - **示例**：考虑以下线性规划问题：
        $$
        \text{最大化 } Z = 3x_1 + 2x_2 \\
            \text{约束条件：} \\
            2x_1 + x_2 \leq 4 \\
            x_1 + x_2 \geq 5 \\
            x_1, x_2 \geq 0
        $$
        
        - 在这个例子中，第二个约束条件 \( x_1 + x_2 \geq 5 \) 与第一个约束条件 \( 2x_1 + x_2 \leq 4 \) 和变量非负条件相冲突，导致不存在同时满足所有约束条件的解。
        
      - 退化解

        - **定义**：在单纯形法迭代过程中，如果出现相同的基变量集，那么问题出现退化解。

        - **示例**：考虑以下线性规划问题：
            $$
            \text{最大化 } Z = 3x_1 + 2x_2 \\
            \text{约束条件：} \\
            2x_1 + x_2 = 4 \\
            x_1 + x_2 = 3 \\
            x_1, x_2 \geq 0
            $$
        
            $$
            \begin{array}{c|cccc|c}
            & x_1 & x_2 & s_1 & s_2 & b \\
            \hline
            Z & 3 & 2 & 0 & 0 & 0 \\
            s_1 & 2 & 1 & 1 & 0 & 4 \\
            s_2 & 1 & 1 & 0 & 1 & 3
            \end{array}
            $$
            - 在这个例子中，如果我们进行迭代，可能会发现在某一点上回到了之前的一个基变量集，这表明问题出现了退化解。

    - 单纯形法的矩阵形式

      - 原问题
        ![image-20240825105943671](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240825110921686.png)

      - 加入松弛变量向量 $X_s$，将问题表示为增广形
        ![image-20240825111610265](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240825111610265.png)

      - $X_B$ 表示基变量矩阵，B 是基变量的系数
        ![image-20240825161533862](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240825161533862.png)

      - 因为 $B*x_B=b$，因为单纯形法只引入基本变量，使得 B 是非奇异的，因此 $B^{-1}$ 总是存在。$x_B=B^{-1}*b$，进而 $Z=C_B*x_B=C_B*B^{-1}*b$​

      - 单纯形表的矩阵表示

        ![image-20240825165807224](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240825165837960.png)
        ![image-20240825165826053](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240825165826053.png)

      - 单纯形法的矩阵形式的计算过程

        1. 初始化
           - 引入松弛变量等，得到初始基本变量。这就产生了初始的 $x_B$、$c_B$、B 和 $B^{-1}$​，然后进行最优性测试。
        2. 迭代
           1) 确定入基变量：参考式(0)中非基本变量的系数。然后选择负系数绝对值最大的变量作为进入基本变量。
           2) 确定出基变量：确定离开基本变量: 使用 $B^{-1} A$(原变量系数)和 $B^{-1}$(松弛变量系数)矩阵表达式，计算除 Eq.(0)外的每个方程中进入基本变量的系数。同样 $x_B=B^{-1}b$(见步骤 3)来确定这些方程的右边，使用最小比率检验来选择剩下的基本变量。
           3) 确定新的 BF 解：更新基矩阵 B，将离开基本变量的列替换为 [A, I] 中进入基本变量的对应列。并对 $x_B$ 和 $c_B$ 进行相应的替换，推导出 $B^{-1}$，$x_B = B^{-1}b$

  - 对偶问题

    - 原问题与对偶问题的对应关系 
      ![image-20240826094802964](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240826094802964.png)![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/bcc31805-baa5-494a-8d58-d4d7fdc5a179-8969563.jpg)
      - 示例
        - 算法形式
          ![image-20240826095028504](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240826095028504.png)

        - 矩阵形式
          ![image-20240826095013494](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240826095013494.png)

    - 性质
      - 对称性原理：对偶问题的对偶是原问题

      - 弱对偶定理：若 X、Y 分别是原问题 LP 与其对偶问题 DP 的可行解，则有 $CX<=Yb$

        - 推论 1：若 X 和 Y 分别是问题 LP 和 DP 的可行解，则：

          - CX 是问题 DP 的目标函数最小值的一个下界；

          - Yb 是问题 LP 的目标函数最大值的一个上界。

        - 推论 2：在一对对偶问题（P）和（D）中，若其中一个问题可行但目标函数无界，则另一个问题不可行。

        - 推论 3：在一对对偶问题（P）和（D）中，若一个可行（如 P），而另一个不可行，（如 D），则该可行的问题无界。

      - 最优性判别定理：若 X  和 Y 分别是 P 和 D 的可行解且 $CX^*= Y^*$ b，则 $X^∗$ 和 $Y^*$ 分别是问题 P 和 D 的最优解。

      - 强对偶定理：若一对对偶问题 P 和 D 都有可行解，则它们都有最优解，且目标函数的最优值必相等。
        - 推论 4 对偶定理(弱对偶性)：若 P 和 D 的任意一个有最优解，则另一个也有最优解，且目标函数的最优值相等。

      - 对偶问题解的关系 ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/d9f9156a-ffde-4e7a-839b-00157f9ac0bb-8969563.jpg)

      - 互补松弛定理：设 $X^∗$ 和 $Y^*$​分别是问题 P 和 D 的可行解，则它们分别是最优解的充要条件是 ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/b2cf8240-eb6d-44c6-8535-4a4b05dc6d09-8969563.jpg)
      - 在每次迭代中，单纯形法同时确定原始问题的CPF解x和对偶问题的互补解y(在第0行，松弛变量的系数中找到)，其中 $CX= Y$。如果x对于原始问题不是最优的，那么y对于对偶问题也是不可行的。

    - 影子价格
      - 影子价格越大，说明这种资源越是相对紧缺

      - 影子价格越小，说明这种资源相对不紧缺

      - 如果最优生产计划下某种资源有剩余，该资源的影子价格一定等于 0

  - 灵敏度分析

    - 分析结果类型
      ![image-20240826154718265](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240826154718265.png)
    - 右端常数项 $b_i$ 的改变

      - 当 $B^{-1}*(b + \Delta b) \geq 0$ ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/dfe307ca-4d96-4757-8d54-cd1b9ef24915-8969563.jpg) ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/4cd23ef4-f944-414b-83fd-03f8c961cf8f-8969563.jpg)
      
    - 若最优基不变，则目标函数值变为 ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/c8a929f6-2123-4888-96a3-3288a4771bb0-8969563.jpg)
    - 目标函数系数 $c_j$ 的改变
    - 非基变量在目标函数中系数的灵敏度分析
        - 要使最优解不变，必须满足 $\sigma_k+\Delta c_k \leq 0$，即：$\Delta c_k \leq -\sigma_k$​
        - 增加一个变量：等价于将一个系数为0的
    - 基变量在目标函数中系数的灵敏度分析 ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/5fa31b79-4a76-4544-8a60-0900e7e67cb1-8969563.jpg) ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/ba9a5276-2d81-4501-8766-2a8f235a0163-8969563.jpg)
    - 技术系数 $a_{ij}$ 的改变
      - 非基变量在 A 中的系数列向量的灵敏度分析
      - 改变基变量的系数
    - 增加一个变量

      - 加入变量 $x_8$ 后单纯形表中的列向量 ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/3e6767bf-0d08-4146-9f41-bbad01987365-8969563.jpg)

      - 加入变量 $x_8$ 后单纯形表中 $x_8$ 的检验数 ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/5714df84-b0a5-4431-af09-650e2348971e-8969563.jpg)

      - 变换过的单纯形表 ![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/9990f19b-deed-45db-98f5-4fa585d3b1eb-8969563.jpg)
    - 增加一个约束

      - 首先判断原问题的最优解是否满足约束条件，如果满足，得到最优；

      - 否则，继续迭代：
        ![image-20240826092740640](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/image-20240826092740640.png)

        - 在最优单纯表上加一行和一列

        - 增加的行以 $X_{n+1}$ 为松弛变量，填入 $a_{m+1,j}$，增加单位列向量 $P_{n+1}$

        - 可能破坏最优表的单位矩阵，需要用初等行变化恢复，继续迭代

  - 运输问题

    基本模型、基本概念、表上作业法

    - 解题过程

      - 找出初始基可行解，即在产销平衡表上给出m+n-1个有数字的格，这些有数字的格不能构成闭回路，且行和等于产量，列和等于销售量；

      - 使用位势法求各非基变量的检验数，判别是否达到最优解。如果达到最优解，则停止计算，否则转入下一步；

      - 确定换入变量和换出变量，找出新的基可行解，在表上用闭回路法进行调整。

      - 重复步骤1和2，直到求得最优解为止。

    - 初始基可行解的构造

      - 最小元素法

      - 西北角法

    - 退化问题的处理：出现退化时，要在同时被划去的行列中任选一个空格填0，此格作为有数字格![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/12707ac7-f9f9-487d-9391-f646c1a10b3b-8969563.jpg)

    - 求检验数

      - 闭回路法求检验数

      - 位势法求检验数

    - 产销不平衡问题

      - 产大于销：增加一个假想的销地n+1，该销地的销量为总产量减去总销量，而各产地到假想销地的单位运价定为0，就转化成产销平衡的运输问题![img](https://raw.githubusercontent.com/Duangboss/Typora-Image/main/img/08962757-fe23-47cb-ae91-c63a22631790-8969563.jpg)

      - 销大于产：增加一个假想的产地m+1，该销地的销量为总销量减去总产量，而假想产地到各销地的单位运价定为0，就转化成产销平衡的运输问题

